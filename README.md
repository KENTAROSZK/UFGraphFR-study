# UFGraphFR: Universal Feature Graph for Federated Recommendation

**UFGraphFR (Universal Feature Graph for Federated Recommendation)** ã¯æ©Ÿæ¢°å­¦ç¿’ã®æ¨è–¦ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦ã€ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã¨ã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’çµ„ã¿åˆã‚ã›ãŸå…ˆé€²çš„ãªãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚

ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ãƒªãƒã‚¸ãƒˆãƒªï¼šhttps://github.com/trueWangSyutung/UFGraphFR

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆæ–°è¦é–‹ç™ºè€…å‘ã‘ï¼‰

### æœ€åˆã«èª­ã‚€ã¹ããƒ•ã‚¡ã‚¤ãƒ«

æ–°è¦é–‹ç™ºãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã«é–¢ã‚ã‚‹æ–¹ã¯ã€ä»¥ä¸‹ã®é †åºã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ï¼š

1. **`train.py`** - ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°è§£æã€å®Ÿè¡Œãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
2. **`mymodel.py`** - ã‚³ã‚¢ãƒ¢ãƒ‡ãƒ«å®Ÿè£…ï¼ˆUFGraphFRã€UFGraphFREngineã€Transformerã€MLPï¼‰
3. **`engine.py`** - åŸºåº•ã‚¨ãƒ³ã‚¸ãƒ³ã‚¯ãƒ©ã‚¹ã€ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã€è¨“ç·´ãƒ»è©•ä¾¡å‡¦ç†
4. **`data.py`** - ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã€SampleGeneratorã€å‰å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯
5. **`embedding.py`** - EmbeddingUtilsã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ã‚¢ã‚¤ãƒ†ãƒ åŸ‹ã‚è¾¼ã¿å‡¦ç†ï¼ˆUSE/MiniLMï¼‰
6. **`utils.py`** - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã€ã‚°ãƒ©ãƒ•æ§‹ç¯‰ã€ãƒ‡ãƒã‚¤ã‚¹è¨­å®š
7. **`metrics.py`** - è©•ä¾¡æŒ‡æ¨™ï¼ˆHit Ratioã€NDCGï¼‰ã®è¨ˆç®—å‡¦ç†

## ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ å‡¦ç†ãƒ•ãƒ­ãƒ¼

```mermaid
graph TD
    A[train.py - ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼] --> B[å¼•æ•°è§£æãƒ»è¨­å®šèª­ã¿è¾¼ã¿]
    B --> C[ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè¨­å®šãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼/ã‚¢ã‚¤ãƒ†ãƒ æ•°è¨­å®š]
    C --> D[data.py - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿]
    D --> E[data.py - SampleGeneratoråˆæœŸåŒ–]
    E --> F[train/validation/teståˆ†å‰²]
    F --> G[embedding.py - EmbeddingUtilsåˆæœŸåŒ–]
    G --> H[USE/MiniLMåŸ‹ã‚è¾¼ã¿ç”Ÿæˆ]
    
    H --> I[mymodel.py - UFGraphFREngineåˆæœŸåŒ–]
    I --> J[mymodel.py - UFGraphFRãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰]
    J --> K[Transformer/MLP/Attention layersåˆæœŸåŒ–]
    
    K --> L[engine.py - ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰è¨“ç·´é–‹å§‹]
    L --> M[å‚åŠ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°]
    M --> N[å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ãƒ¼ã‚«ãƒ«è¨“ç·´]
    N --> O[engine.py - fed_train_single_batch]
    O --> P[ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°]
    P --> Q[utils.py - ã‚°ãƒ©ãƒ•æ§‹ç¯‰ãƒ»é›†ç´„]
    Q --> R[ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢ä¿‚ã‚°ãƒ©ãƒ•æ›´æ–°]
    
    R --> S[engine.py - è©•ä¾¡ãƒ•ã‚§ãƒ¼ã‚º]
    S --> T[metrics.py - Hit Ratio/NDCGè¨ˆç®—]
    T --> U[æ¬¡ãƒ©ã‚¦ãƒ³ãƒ‰ã¾ãŸã¯çµ‚äº†åˆ¤å®š]
    
    U --> L
    U --> V[çµæœä¿å­˜ãƒ»ãƒ­ã‚°å‡ºåŠ›]

    style A fill:#e1f5fe
    style J fill:#f3e5f5
    style L fill:#e8f5e8
    style S fill:#fff3e0
    style V fill:#ffe0e0
```

### è©³ç´°ãªå‡¦ç†ãƒ•ãƒ­ãƒ¼èª¬æ˜

1. **åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º** (`train.py`)
   - ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®è§£æ
   - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå›ºæœ‰ã®è¨­å®šï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã€ã‚¢ã‚¤ãƒ†ãƒ æ•°ï¼‰
   - ãƒ¢ãƒ‡ãƒ«ã‚¨ãƒ³ã‚¸ãƒ³ã®é¸æŠï¼ˆUFGraphFREngine or MLPEngineï¼‰

2. **ãƒ‡ãƒ¼ã‚¿æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º** (`data.py`, `embedding.py`)
   - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿ï¼ˆratings.dat, u.userç­‰ï¼‰
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ã‚¢ã‚¤ãƒ†ãƒ IDã®å†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
   - åŸ‹ã‚è¾¼ã¿ç”Ÿæˆï¼ˆUniversal Sentence Encoder/MiniLMï¼‰

3. **è¨“ç·´ãƒ«ãƒ¼ãƒ—** (`engine.py`)
   - å„ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‚åŠ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
   - ãƒ­ãƒ¼ã‚«ãƒ«è¨“ç·´ã®å®Ÿè¡Œ
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é›†ç´„ã¨ã‚°ãƒ©ãƒ•æ›´æ–°

4. **è©•ä¾¡ãƒ»æ¤œè¨¼** (`metrics.py`)
   - Hit Ratio@10ã¨NDCG@10ã®è¨ˆç®—
   - æœ€è‰¯çµæœã®è¨˜éŒ²ã¨ãƒ­ã‚°å‡ºåŠ›

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 1. **ãƒ¢ãƒ‡ãƒ«å±¤** (`mymodel.py`)
- **UFGraphFR**: ãƒ¡ã‚¤ãƒ³ã®æ¨è–¦ãƒ¢ãƒ‡ãƒ«
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼åŸ‹ã‚è¾¼ã¿ï¼ˆLinear/Embeddingï¼‰
  - ã‚¢ã‚¤ãƒ†ãƒ åŸ‹ã‚è¾¼ã¿ï¼ˆEmbeddingï¼‰
  - ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ï¼ˆTransformerBlockKanï¼‰
  - MLPå±¤ï¼ˆCommonMLPï¼‰
- **TransformerBlockKan**: ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³æ©Ÿæ§‹
- **CommonMLP**: å…±é€šMLPå±¤
- **MultiheadAttention**: ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³å®Ÿè£…
- **UFGraphFREngine**: ã‚¨ãƒ³ã‚¸ãƒ³ã‚¯ãƒ©ã‚¹ï¼ˆEngineã‚’ç¶™æ‰¿ï¼‰

#### 2. **ã‚¨ãƒ³ã‚¸ãƒ³å±¤** (`engine.py`)
- **Engine**: åŸºåº•è¨“ç·´ãƒ»è©•ä¾¡ã‚¨ãƒ³ã‚¸ãƒ³
  - `fed_train_a_round()`: ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ
  - `fed_train_single_batch()`: ãƒãƒƒãƒå˜ä½ã®è¨“ç·´
  - `fed_evaluate()`: è©•ä¾¡å‡¦ç†
  - `aggregate_clients_params()`: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é›†ç´„
- ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ-ã‚µãƒ¼ãƒãƒ¼é–“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é›†ç´„

#### 3. **ãƒ‡ãƒ¼ã‚¿å±¤** (`data.py`)
- **SampleGenerator**: ãƒ‡ãƒ¼ã‚¿åˆ†å‰²ãƒ»è² ä¾‹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
  - `store_all_train_data()`: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
  - `validate_data/test_data`: æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
- **UserItemRatingDataset**: PyTorchãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ã‚¢ã‚¤ãƒ†ãƒ ã€è©•ä¾¡ã®ãƒ†ãƒ³ã‚½ãƒ«åŒ–

#### 4. **åŸ‹ã‚è¾¼ã¿å±¤** (`embedding.py`)
- **EmbeddingUtils**: ãƒ†ã‚­ã‚¹ãƒˆåŸ‹ã‚è¾¼ã¿ç”Ÿæˆ
  - `embedding_users()`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‰¹å¾´ã®åŸ‹ã‚è¾¼ã¿
  - Universal Sentence Encoder (USE)ã‚µãƒãƒ¼ãƒˆ
  - MiniLM-L6ã‚µãƒãƒ¼ãƒˆ
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›ãƒ»åŸ‹ã‚è¾¼ã¿

#### 5. **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å±¤** (`utils.py`)
- ãƒ‡ãƒã‚¤ã‚¹è¨­å®šï¼ˆCUDA/MPSï¼‰
- ã‚°ãƒ©ãƒ•æ§‹ç¯‰é–¢æ•°
- æ­£å‰‡åŒ–è¨ˆç®—
- ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç®¡ç†

#### 6. **è©•ä¾¡å±¤** (`metrics.py`)
- **MetronAtK**: Top-Kè©•ä¾¡æŒ‡æ¨™
  - Hit Ratio@Kè¨ˆç®—
  - NDCG@Kè¨ˆç®—

## ğŸ“‹ ä¸»è¦è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | èª¬æ˜ |
|-----------|-------------|------|
| `--alias` | UFGraphFR | ãƒ¢ãƒ‡ãƒ«å |
| `--dataset` | 100k | ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆé¸æŠ |
| `--latent_dim` | 32 | æ½œåœ¨æ¬¡å…ƒæ•° |
| `--batch_size` | 256 | ãƒãƒƒãƒã‚µã‚¤ã‚º |
| `--lr` | 0.1 | å­¦ç¿’ç‡ |
| `--num_round` | 100 | ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ã‚¦ãƒ³ãƒ‰æ•° |
| `--use_transfermer` | True | Transformerä½¿ç”¨ãƒ•ãƒ©ã‚° |
| `--use_jointembedding` | True | çµåˆåŸ‹ã‚è¾¼ã¿ä½¿ç”¨ãƒ•ãƒ©ã‚° |
| `--use_cuda` | False | CUDAä½¿ç”¨ãƒ•ãƒ©ã‚° |
| `--use_mps` | False | MPS (Apple Silicon) ä½¿ç”¨ãƒ•ãƒ©ã‚° |

## ğŸ”§ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦ãªä¾å­˜é–¢ä¿‚

```bash
# Poetryä½¿ç”¨ã®å ´åˆ
poetry install

# pipã®å ´åˆ
pip install -r requirements.txt
```

### ä¸»è¦ä¾å­˜é–¢ä¿‚
- PyTorch 2.3.0+
- MediaPipe 0.10.15+
- pandas 2.2.2+
- scikit-learn 1.5.1+
- sentence-transformers 3.2.1+

## ğŸƒ å®Ÿè¡Œæ–¹æ³•

### Macã§ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã‚‹å ´åˆ
```bash
poetry run python train.py --use_mps True --batch_size 128 --latent_dim 16 --pre_model MiniLM-L6 --embed_dim 384 --layers "32, 16, 8"
```

### åŸºæœ¬å®Ÿè¡Œ
```bash
python train.py --dataset 100k --num_round 50
```

### GPUä½¿ç”¨
```bash
python train.py --use_cuda True --device_id 0
```

### Apple Silicon (MPS) ä½¿ç”¨
```bash
python train.py --use_mps True
```

### ã‚«ã‚¹ã‚¿ãƒ è¨­å®š
```bash
python train.py \
    --dataset ml-1m \
    --latent_dim 64 \
    --batch_size 512 \
    --lr 0.01 \
    --num_round 100 \
    --use_transfermer True \
    --use_jointembedding True
```

## ğŸ“ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæ§‹é€ 

ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼š
- `100k`: MovieLens 100K
- `ml-1m`: MovieLens 1M  
- `lastfm-2k`: Last.fm 2K
- `hetres-2k`: HetRec 2K
- `amazon`: Amazon reviews
- `douban`: Douban

ãƒ‡ãƒ¼ã‚¿å½¢å¼ï¼š
```
data/
â”œâ”€â”€ 100k/
â”‚   â”œâ”€â”€ ratings.dat
â”‚   â”œâ”€â”€ u.item
â”‚   â””â”€â”€ u.user
â”œâ”€â”€ ml-1m/
â”‚   â”œâ”€â”€ ratings.dat
â”‚   â””â”€â”€ u.user
â””â”€â”€ ...
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### GPUä½¿ç”¨æ™‚ã®æ¨å¥¨è¨­å®š
```bash
python train.py --use_cuda True --batch_size 512 --lr 0.01
```

### ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–
```bash
python train.py --batch_size 128 --latent_dim 16
```

## ğŸ§ª è©•ä¾¡æŒ‡æ¨™

- **Hit Ratio@K**: ãƒˆãƒƒãƒ—Kæ¨è–¦ã«ãŠã‘ã‚‹å‘½ä¸­ç‡
- **NDCG@K**: æ­£è¦åŒ–å‰²å¼•ç´¯ç©åˆ©å¾—
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: K=10

## ğŸ” ãƒ‡ãƒãƒƒã‚°ãƒ»é–‹ç™ºã®ãƒ’ãƒ³ãƒˆ

### 1. ä¸»è¦ãªé–‹ç™ºãƒã‚¤ãƒ³ãƒˆ

#### ãƒ¢ãƒ‡ãƒ«å®Ÿè£…ã®ç¢ºèªãƒã‚¤ãƒ³ãƒˆ (`mymodel.py`)
```python
# UFGraphFRãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ç¢ºèª
print(model)  # ãƒ¢ãƒ‡ãƒ«æ§‹é€ ã‚’å‡ºåŠ›
print(f"User embedding: {model.embedding_user}")
print(f"Item embedding: {model.embedding_item}")
```

#### è¨“ç·´ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ‡ãƒãƒƒã‚° (`engine.py`)
```python
# fed_train_a_roundå†…ã§ã®ãƒ‡ãƒãƒƒã‚°
print(f"Round {round_id}, Participants: {len(participants)}")
print(f"User {user}, Loss: {loss.item()}")
```

#### ãƒ‡ãƒ¼ã‚¿å½¢çŠ¶ã®ç¢ºèª (`data.py`)
```python
# SampleGeneratorå†…ã§
print(f"Train: {len(train_data)}, Val: {len(val_data)}, Test: {len(test_data)}")
print(f"User range: [{min_user}, {max_user}]")
```

### 2. ä¸»è¦ãªé–¢æ•°ãƒ»ã‚¯ãƒ©ã‚¹ã®å½¹å‰²

#### `train.py`ã®ä¸»è¦éƒ¨åˆ†
- `train(config)`: ãƒ¡ã‚¤ãƒ³è¨“ç·´é–¢æ•°
- ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆåˆ¥ã®è¨­å®šï¼ˆml-1m, 100k, lastfm-2kç­‰ï¼‰
- ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®è§£æ

#### `engine.py`ã®ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰
- `fed_train_a_round()`: 1ãƒ©ã‚¦ãƒ³ãƒ‰ã®è¨“ç·´å®Ÿè¡Œ
- `fed_train_single_batch()`: ãƒãƒƒãƒå˜ä½ã®è¨“ç·´
- `fed_evaluate()`: è©•ä¾¡å®Ÿè¡Œ
- `aggregate_clients_params()`: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é›†ç´„

#### `mymodel.py`ã®ä¸»è¦ã‚¯ãƒ©ã‚¹
- `UFGraphFR`: ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
- `UFGraphFREngine`: ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…
- `TransformerBlockKan`: ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³æ©Ÿæ§‹
- `CommonMLP`: MLPå±¤

### 3. é–‹ç™ºæ™‚ã®æ³¨æ„ç‚¹

#### ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®å®Ÿè£…
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ãƒ­ãƒ¼ã‚«ãƒ«è¨“ç·´
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®é›†ç´„å‡¦ç†
- ã‚°ãƒ©ãƒ•æ§‹ç¯‰ã«ã‚ˆã‚‹çŸ¥è­˜å…±æœ‰

#### ãƒ‡ãƒã‚¤ã‚¹å¯¾å¿œ
- CUDA/MPS/CPUã®åˆ‡ã‚Šæ›¿ãˆ
- ãƒ†ãƒ³ã‚½ãƒ«ã®ãƒ‡ãƒã‚¤ã‚¹ç§»å‹•
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã®æœ€é©åŒ–

#### ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ã‚¢ã‚¤ãƒ†ãƒ IDã®å†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- è² ä¾‹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
- åŸ‹ã‚è¾¼ã¿ç”Ÿæˆ

## ğŸ“š ã•ã‚‰ãªã‚‹è©³ç´°

### é–¢é€£è«–æ–‡ãƒ»å‚è€ƒæ–‡çŒ®

### ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
Open Academic Community License V1

### é–‹ç™ºè€…å‘ã‘æ³¨æ„äº‹é …
- å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å³å¯†ã«è¨˜è¿°
- NumPyå½¢å¼ã®docstringã‚’ä½¿ç”¨
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®çµåˆåº¦ã‚’æœ€å°åŒ–
- Pydanticã¾ãŸã¯dataclassã‚’æ´»ç”¨

---

ğŸ’¡ **é–‹ç™ºæ™‚ã®Tips**: 
- æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€ã¾ãš`train.py`ã§å…¨ä½“ã®æµã‚Œã‚’æŠŠæ¡
- `mymodel.py`ã§ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç¢ºèª
- `engine.py`ã§ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ãƒ†ãƒƒãƒ‰ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç†è§£
- `data.py`ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Ÿè£…ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™

ğŸ¯ **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æŒ‡é‡**:
- å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å³å¯†ã«è¨˜è¿°ï¼ˆPython 3.10+ã®æ–°è¨˜æ³•ä½¿ç”¨ï¼‰
- NumPyå½¢å¼ã®docstringã‚’ä½¿ç”¨
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®çµåˆåº¦ã‚’æœ€å°åŒ–
- Pydanticã¾ãŸã¯dataclassã‚’æ´»ç”¨ã—ãŸå¼•æ•°è¨­è¨ˆ


